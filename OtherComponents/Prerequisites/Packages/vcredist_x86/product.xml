<?xml version="1.0" encoding="utf-8" ?> 

<Product xmlns="http://schemas.microsoft.com/developer/2004/01/bootstrapper" ProductCode="Microsoft.Visual.C++.14.0.x86">

  <!-- Defines list of files to be copied on build -->
  <PackageFiles CopyAllPackageFiles="false">
    <PackageFile Name="vcredist_x86.exe" HomeSite="VCRedistExe" PublicKey="3082010a028201010092fc6f36bbe103b928d646d1a261baa546fb63163e2ef947d2c7ecedc799b1265175bddacc0f061411a46c199ec05f4d5489e44d50d88dcda161a577139a1ca7ed0d74f7a75679e828f753d2b17a63e0f59497b7ecd947f86c3df32588b3bc0ac504a78e7c8548761c6146aa19c47a628bc1c235aafb586fc5630b934930811b7bdf7f7c4fb4476d5f781cafb6f7961352efb9d14d39e573de484e3c14aa970d39cc8b51e15cd13bf08e67ea3060a94d5a9d43bddb23bac00fd74b109d9c4df051a284aae49ca73dd6a3ef0a1848a8fab14ea5980e4bbff014f300c8b048d65bfe38d789112d05ba43024f22009625ad7d356e8468ab20183828fe1ca210b1a50203010001" />
  </PackageFiles>

  <InstallChecks>
    <!--<MsiProductCheck Property="VCRedistInstalled" Product="{65AD78AD-D23D-3A1E-9305-3AE65CD522C2}"/>-->
    <RegistryCheck Property="VCRedistInstalled" Key="HKLM\SOFTWARE\Microsoft\VisualStudio\14.0\VC\Runtimes\x86" Value="Installed"/>
  </InstallChecks>

  <!-- Defines how to invoke the setup for the Visual C++ 14.0 redist -->
  <Commands Reboot="Defer">
    <Command PackageFile="vcredist_x86.exe" Arguments=' /q:a '>

      <!-- These checks determine whether the package is to be installed -->
      <InstallConditions>
        <BypassIf Property="VCRedistInstalled" Compare="ValueEqualTo" Value="1"/>
        <!-- Block install if user does not have admin privileges -->
        <FailIf Property="AdminUser" Compare="ValueEqualTo" Value="false" String="AdminRequired"/>
        <!-- Block install on Win95 -->
        <FailIf Property="Version9X" Compare="VersionLessThan" Value="4.10" String="InvalidPlatformWin9x"/>
        <!-- Block install on Vista or below -->
        <FailIf Property="VersionNT" Compare="VersionLessThan" Value="6.00" String="InvalidPlatformWinNT"/>
      </InstallConditions>

      <ExitCodes>
        <ExitCode Value="0" Result="Success"/>
        <ExitCode Value="3010" Result="SuccessReboot"/>
        <DefaultExitCode Result="Fail" FormatMessageFromSystem="true" String="GeneralFailure" />
      </ExitCodes>

    </Command>
  </Commands>
</Product>
