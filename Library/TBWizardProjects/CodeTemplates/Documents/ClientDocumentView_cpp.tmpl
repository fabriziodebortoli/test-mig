//=============================================================================
// module name  : @(ClientDocumentViewFileName).cpp
//=============================================================================

#include "stdafx.h" 

@(DeleteDuplicatedLines(@(+)
@(RepeatOnDBTs{#include <@(TableModuleName)\@(TableLibrarySourceFolder)\@(TableClassName).h>, "\r\n"})\n@(+)
@(RepeatOnDBTs{#include <@(DBTModuleName)\@(DBTLibrarySourceFolder)\@(DBTClassName).h>, "\r\n"})\n@(+)
#include <@(ModuleName)\@(LibrarySourceFolder)\@(ClientDocumentClassName).h>\n@(+)
#include <@(ModuleName)\@(LibrarySourceFolder)\@(ClientDocumentViewFileName).h>\n@(+)
))

#include <@(ModuleName)\@(LibrarySourceFolder)\@(ClientDocumentViewFileName).hrc> 

//TBWIZ-INJECT{@(ClientDocumentViewClassName)(IncludeFiles)
//TBWIZ-INJECT}

#ifdef _DEBUG
#undef THIS_FILE
static char THIS_FILE[] = __FILE__; 
#endif

@(IsSlaveFormViewToCreate{@(+)
//////////////////////////////////////////////////////////////////////////////\n@(+)
//						@(ClientDocumentViewClassName)						//\n@(+)
//////////////////////////////////////////////////////////////////////////////\n@(+)
IMPLEMENT_DYNCREATE(@(ClientDocumentViewClassName), CSlaveFormView)\n@(+)
\n@(+)
//-----------------------------------------------------------------------------\n@(+)
BEGIN_MESSAGE_MAP(@(ClientDocumentViewClassName), CSlaveFormView)\n@(+)
	\t//{{AFX_MSG_MAP(@(ClientDocumentViewClassName))\n@(+)
	\t//TBWIZ-INJECT{@(ClientDocumentViewClassName)(MessageMap)\n@(+)
	\t//TBWIZ-INJECT}\n@(+)
	\t//}}AFX_MSG_MAP\n@(+)
END_MESSAGE_MAP()\n@(+)
\n@(+)
//-----------------------------------------------------------------------------\n@(+)
@(ClientDocumentViewClassName)::@(ClientDocumentViewClassName)()\n@(+)
	\t:\n@(+)
	\tCSlaveFormView(_NS_VIEW("@(ClientDocumentName)"), IDD_@@(_RB(_)ClientDocumentName)_SLAVEFORMVIEW)\n@(+)
{\n@(+)
}\n@(+)
\n@(+)
//-----------------------------------------------------------------------------\n@(+)
void @(ClientDocumentViewClassName)::BuildDataControlLinks()\n@(+)
{\n@(+)
	\tGetFrame()->SetSubTitle(_TB("@(ClientDocumentTitle)"));\n@(+)
\n@(+)
    \t@(IsTabberToCreate(AddTabManager(IDC_@@(_RB(_)ClientDocumentName)_TAB, RUNTIME_CLASS(C@(ClientDocumentName)Tabber), _NS_TABMNG("@(ClientDocumentName)"));))\n@(+)
}\n@(+)

@(IsTabberToCreate{@(+)
//==============================================================================\n@(+)
//  C@(ClientDocumentName)Tabber\n@(+)
//==============================================================================\n@(+)
IMPLEMENT_DYNCREATE(C@(ClientDocumentName)Tabber, CTabManager)\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
void C@(ClientDocumentName)Tabber::Customize()\n@(+)
{\n@(+)
	@(RepeatOnTabbedPanes{\tAddDialog(RUNTIME_CLASS(C@(ClientDocumentName)@(TabbedPaneName)TabDlg), IDD_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName));\n, "\r\n"})\n@(+)
	\t//TBWIZ-INJECT{C@(ClientDocumentName)Tabber(Customize)\n@(+)
	\t//TBWIZ-INJECT}\n@(+)
}\n\n@(+)
})})

@(RepeatOnTabbedPanes{@(+)
@(IfDBTSlaveBuffered{@(+)
@(_NOEMPTYLINES:IfCreateRowForm{@(+)
//==============================================================================\n@(+)
//	C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView\n@(+)
//==============================================================================\n@(+)
IMPLEMENT_DYNCREATE(C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView, CRowFormView)\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
BEGIN_MESSAGE_MAP(C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView, CRowFormView)\n@(+)
	\t//{{AFX_MSG_MAP(C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView)\n@(+)
	\t//TBWIZ-INJECT{C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView(MessageMap)\n@(+)
	\t//TBWIZ-INJECT}\n@(+)
	\t//}}AFX_MSG_MAP\n@(+)
END_MESSAGE_MAP()\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView::C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView()\n@(+)
	\t:\n@(+)
	\tCRowFormView(_T("@(DBTSlaveTabTitle)"), IDD_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_ROW_FORM)\n@(+)
{}\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
void C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView::BuildDataControlLinks()\n@(+)
{\n@(+)
	\t@(TableClassName)* pRecord = Get@(TableClassName)();\n@(+)
	@(RepeatOnRowFormColumns{@(+)
		\tAddLink\n@(+)
			\t(\n@(+)
				\t\tIDC_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_ROW_FORM_@@(ColumnName),\n@(+)
				\t\t@(IfBaseTableColumn(RDC(pRecord, f_@(ColumnName))))@(IfAdditionalColumn(_NS_LNK("@(ColumnName)"),\n\t\tAFC(((@(AdditionalColumnsClassName)*)(pRecord->GetAddOnFields(RUNTIME_CLASS(@(AdditionalColumnsClassName))))), f_@(ColumnName)))),\n@(+)
				\t\tRUNTIME_CLASS(@(ColumnParsedControlClassName))\n@(+)
			\t);@(+)
	, "\r\n"@(+)
	})\n@(+)
}\n@(+)
})@(+)
//==============================================================================\n@(+)
//  C@(ClientDocumentName)@(TabbedPaneName)BodyEdit\n@(+)
//==============================================================================\n@(+)
IMPLEMENT_DYNCREATE(C@(ClientDocumentName)@(TabbedPaneName)BodyEdit, CBodyEdit)\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
C@(ClientDocumentName)@(TabbedPaneName)BodyEdit::C@(ClientDocumentName)@(TabbedPaneName)BodyEdit()\n@(+)
\t:\n@(+)
\tCBodyEdit(_NS_BE("@(TableName)"))\n@(+)
{\n@(+)
}\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
void C@(ClientDocumentName)@(TabbedPaneName)BodyEdit::Customize()\n@(+)
{\n@(+)
	\tEnableOrdering(TRUE);\n@(+)
@(IfIsDBTRecordToEnhance(\tTEnhanced@(DBTClassName)@(TableClassName)* pRecord = (TEnhanced@(DBTClassName)@(TableClassName)*)(m_pDBT->GetRecord());\n))@(+)
@(IfIsDBTRecordNotToEnhance(\t@(TableClassName)* pRecord = (@(TableClassName)*)(m_pDBT->GetRecord());\n))@(+)
    \tColumnInfo*	pColumnInfo;\n\n@(+)
	@(RepeatOnVisibleColumns{@(+)
	\tpColumnInfo = AddColumn\n@(+)
	\t(\n@(+)
		\t\t_NS_CLN("@(ColumnName)"),\n@(+)
		\t\t_TB("@(ColumnTitle)"),\n@(+)
		\t\t0,\n@(+)
		\t\tIDC_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_@@(ColumnName),\n@(+)
		\t\t&(@(IfBaseTableColumn(pRecord))@(IfAdditionalColumn(((@(AdditionalColumnsClassName)*)(pRecord->GetAddOnFields(RUNTIME_CLASS(@(AdditionalColumnsClassName)))))))->f_@(ColumnName)),\n@(+)
		\t\tRUNTIME_CLASS(@(ColumnParsedControlClassName))@(IfHKLDefinedColumn(,\n\t\tGetClientDocument()->m_pHKL@(_RB(_)TabbedPaneName)@(ColumnName)))\n@(+)
	\t);\n@(+)
	@(IfColumnLengthIsGreaterThanMaxBodyEditColumnWidth{\tpColumnInfo->SetCtrlSize(@(MaxBodyEditColumnWidth), @(BodyEditColumnRowsNumber), @(DataLength));\n})@(+)
	\t//TBWIZ-INJECT{C@(ClientDocumentName)@(TabbedPaneName)BodyEdit(Add@(ColumnName)Column)\n@(+)
	\t//TBWIZ-INJECT}\n@(+)
	@(IfColumnShowsHotLinkDescription{\n@(+)
	\tpColumnInfo = AddColumn\n@(+)
	\t(\n@(+)
		\t\t_NS_CLN("@(_RB(_)DBTName)@(ColumnName)HotLinkDescription"),\n@(+)
		\t\t_TB("@(ColumnHKLDescriptionColumnName)"),\n@(+)
		\t\t0,\n@(+)
		\t\tIDC_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_@@(ColumnName)_HOTLINK_DESCRIPTION_LABEL,\n@(+)
		\t\t&(pRecord->l_@(ColumnHKLTableName)@(ColumnHKLDescriptionColumnName)),\n@(+)
		\t\tRUNTIME_CLASS(@(ColumnHKLDescriptionParsedStaticName))\n@(+)
	\t);\n@(+)
	\t//TBWIZ-INJECT{C@(ClientDocumentName)@(TabbedPaneName)BodyEdit(Add@(_RB(_)DBTName)@(ColumnName)HotLinkDescriptionColumn)\n@(+)
	\t//TBWIZ-INJECT}\n})@(+)
	, "\r\n"@(+)
	})\n@(+)
}\n\n@(+)
})@(+)

//==============================================================================\n@(+)
//  C@(ClientDocumentName)@(TabbedPaneName)TabDlg\n@(+)
//==============================================================================\n@(+)
IMPLEMENT_DYNCREATE(C@(ClientDocumentName)@(TabbedPaneName)TabDlg, CTabDialog)\n\n@(+)
//-----------------------------------------------------------------------------\n@(+)
C@(ClientDocumentName)@(TabbedPaneName)TabDlg::C@(ClientDocumentName)@(TabbedPaneName)TabDlg()\n@(+)
\t:\n@(+)
\tCTabDialog(_NS_TABDLG("@(TableName)"), IDD_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName))\n@(+)
{\n@(+)
}\n@(+)
//-----------------------------------------------------------------------------\n@(+)
void C@(ClientDocumentName)@(TabbedPaneName)TabDlg::BuildDataControlLinks()\n@(+)
{\n@(+)
	@(IfNotDBTSlaveBuffered{@(+)
		\t@(TableClassName)* pRecord = Get@(TableClassName)();\n@(+)
		@(RepeatOnVisibleColumns{@(+)
		\tAddLink\n@(+)
			\t(\n@(+)
				\t\tIDC_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_@@(ColumnName),\n@(+)
				@(IfIsNotTableReferenced(\t\t@(IfBaseTableColumn(RDC(pRecord, f_@(ColumnName))))@(IfAdditionalColumn(_NS_LNK("@(ColumnName)"),\n\t\tAFC(((@(AdditionalColumnsClassName)*)(pRecord->GetAddOnFields(RUNTIME_CLASS(@(AdditionalColumnsClassName))))), f_@(ColumnName)))),\n))@(+)
				@(IfIsTableReferenced(\t\t_T("@(TableName)_@(ColumnName)"),\n\t\tpRecord,\n\t\t&@(IfBaseTableColumn(pRecord))@(IfAdditionalColumn(((@(AdditionalColumnsClassName)*)(pRecord->GetAddOnFields(RUNTIME_CLASS(@(AdditionalColumnsClassName)))))))->f_@(ColumnName),\n))@(+)
				\t\tRUNTIME_CLASS(@(ColumnParsedControlClassName))@(IfHKLDefinedColumn(,\n\t\tGetClientDocument()->m_pHKL@(_RB(_)TabbedPaneName)@(ColumnName)))\n@(+)
			\t);@(+)
		@(IfColumnShowsHotLinkDescription{\n\tAddLink\n\t(\n\t\tIDC_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_@@(ColumnName)_HOTLINK_DESCRIPTION_LABEL,\n\t\t_NS_LNK("@(_RB(_)DBTName)@(ColumnName)HotLinkDescription"),\n\t\tSDC(m_@(_RB(_)DBTName)@(ColumnName)HotLinkDescription),\n\t\tRUNTIME_CLASS(@(ColumnHKLDescriptionParsedStaticName))\n\t);})@(+)
		, "\r\n"@(+)
		})\n@(+)
	})@(+)
	@(IfDBTSlaveBuffered{@(+)
	\tAddLink\n@(+)
		\t(\n@(+)
			\t\tIDC_@@(_RB(_)ClientDocumentName)_@@(_RB(_)TabbedPaneName)_BODY_EDIT,\n@(+)
			\t\tGetClientDocument()->m_p@(DBTClassName),\n@(+)
			\t\tRUNTIME_CLASS(C@(ClientDocumentName)@(TabbedPaneName)BodyEdit),\n@(+)
			\t\t@(IfNotCreateRowForm(NULL))@(IfCreateRowForm(RUNTIME_CLASS(C@(ClientDocumentName)@(TabbedPaneName)BodyEditRowView))),\n@(+)
			\t\t_TB("@(DBTSlaveTabTitle)")\n@(+)
		\t);@(+)
	})@(+)
	\n@(+)
	\t//TBWIZ-INJECT{C@(ClientDocumentName)@(TabbedPaneName)TabDlg(BuildDataControlLinks)\n@(+)
	\t//TBWIZ-INJECT}\n@(+)
}\n@(+)
, "\r\n"@(+)
})

//TBWIZ-INJECT{@(ClientDocumentViewClassName)(AdditionalCode)
//TBWIZ-INJECT}
