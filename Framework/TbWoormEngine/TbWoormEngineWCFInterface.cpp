//BEGIN_HEADING - file version: 1.0
//WARNING - automatically generated code - DO NOT EDIT THIS FILE!

#include "stdafx.h"

//BEGIN_SOURCE_INCLUDE
#include	"queryobject.h"
//END_SOURCE_INCLUDE

#include <atlsafe.h>
#include <TbGeneric\WebServiceStateObjects.h>
#include <TBNameSolver\Templates.h>
//END_HEADING


namespace TbWoormEngineTbWoormEngine {

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) long __Query_Create(HWND _hwnd, long pSymbolTable, long pSession) throw(...)
	{

		if (_hwnd != GetThreadMainWnd())
			return AfxInvokeThreadGlobalFunction<long, HWND, long, long>(_hwnd , &__Query_Create, _hwnd, pSymbolTable, pSession);

		SymTable* pSymbolTableParam;
		pSymbolTableParam = (SymTable*)pSymbolTable;

		SqlSession* pSessionParam;
		pSessionParam = (SqlSession*)pSession;


		QueryObject* pObj = new QueryObject(pSymbolTableParam, pSessionParam);


		AfxAddWebServiceStateObject(pObj);

		return (long)pObj;

	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_Dispose(HWND _hwnd, long handle) throw(...)
	{

		if (_hwnd != GetThreadMainWnd())
			return AfxInvokeThreadGlobalFunction<bool, HWND, long>(_hwnd , &__Query_Dispose, _hwnd, handle);

		if (!AfxExistWebServiceStateObject((CObject*)handle))
		{
			return false;
		} 
		AfxRemoveWebServiceStateObject((CObject*)handle, TRUE);

		return true;


	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_Define(HWND _hwnd, long handle, BSTR dsSql) throw(...)
	{

		DataBool returnValueParam;

		DataStr dsSqlParam;
		dsSqlParam.SetCollateCultureSensitive(TRUE);
		dsSqlParam.SetSoapValue(dsSql);


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataBool, QueryObject, DataStr>(_hwnd, &obj, &QueryObject::Define, dsSqlParam);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) BSTR __Query_GetColumnName(HWND _hwnd, long handle, int index) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		DataInt indexParam;
		indexParam.SetSoapValue(index);


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataStr, QueryObject, DataInt>(_hwnd, &obj, &QueryObject::GetColumnName, indexParam);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) long __Query_GetData(HWND _hwnd, long handle, BSTR name) throw(...)
	{

		DataObj* returnValueParam;

		DataStr nameParam;
		nameParam.SetCollateCultureSensitive(TRUE);
		nameParam.SetSoapValue(name);


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataObj*, QueryObject, DataStr>(_hwnd, &obj, &QueryObject::GetData, nameParam);

		AfxAddWebServiceStateObject(returnValueParam, _hwnd);


		return (long)returnValueParam;

	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) BSTR __Query_GetValue(HWND _hwnd, long handle, BSTR sName) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		DataStr sNameParam;
		sNameParam.SetCollateCultureSensitive(TRUE);
		sNameParam.SetSoapValue(sName);


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataStr, QueryObject, DataStr>(_hwnd, &obj, &QueryObject::GetValue, sNameParam);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_Open(HWND _hwnd, long handle) throw(...)
	{

		DataBool returnValueParam;


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataBool, QueryObject>(_hwnd, &obj, &QueryObject::Open);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_Close(HWND _hwnd, long handle) throw(...)
	{

		DataBool returnValueParam;


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataBool, QueryObject>(_hwnd, &obj, &QueryObject::Close);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_Read(HWND _hwnd, long handle) throw(...)
	{

		DataBool returnValueParam;


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataBool, QueryObject>(_hwnd, &obj, &QueryObject::Read);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_ReadOne(HWND _hwnd, long handle) throw(...)
	{

		DataBool returnValueParam;


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataBool, QueryObject>(_hwnd, &obj, &QueryObject::ReadOne);


		return returnValueParam.GetSoapValue();
	}

	//File: Framework\TbWoormEngine\QueryObject.cpp.
	extern "C" __declspec(dllexport) bool __Query_Execute(HWND _hwnd, long handle) throw(...)
	{

		DataBool returnValueParam;


		CObject* pObj = ((CObject*)handle);

		if (!pObj->IsKindOf(RUNTIME_CLASS(QueryObject)))
			throw new CApplicationErrorException(_T("Invalid context object: QueryObject"));

		QueryObject& obj = *((QueryObject*)pObj);
		returnValueParam = AfxInvokeThreadFunction<DataBool, QueryObject>(_hwnd, &obj, &QueryObject::Execute);


		return returnValueParam.GetSoapValue();
	}
}

TB_REGISTER_SOAP_SERVICE(TbWoormEngineTbWoormEngine::CTbWoormEngineTbWoormEngine)