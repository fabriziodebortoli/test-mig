//==============================================================================
// Woorm code behind
//==============================================================================

Release 7 Rect (49,2,1038,1918) ReportTemplate "Report.erp.core.Basic.wrmt" 

Properties
	Begin
		Title "ISO Country Codes" 
		Subject "" 
		Author "" 
		ReportProducer "" 
		Comments "" 
		DefaultSecurityRoles "Accounting" 
	End

PageInfo (2,9,2970,2100,100,1,1,True ) 

FontStyles 
	Begin
		"CellTextBig"  Facename "Open Sans"  Size 11 Style (0,0,0,700,255,0,0,0,3,2,1,34,TextColor (0,0,0) ) ;
		"ColumnTitleBig"  Facename "Calibri"  Size 16 Style (0,0,0,700,0,0,0,0,3,2,1,34,TextColor (0,255,0) ) ;
	End

PageLayout "default" 
	Begin
		Field (9,12,37,1066) Alias 8  /* w_CompanyName */ 
			Begin
				Style "CompanyName" 

			End

		Text (9,940,37,1066) "{Application Date} {Time}" 
			Begin
				Style "Date" 
				Special
			End

		Text (30,9,64,1066) "ISO Country Codes" 
			Begin
				Style "ListTitleUnderline" 
			End

		SqrRect (72,11,139,202) Ratio (20,20) 
			Begin
				Pen (255,20,147) Size 3;
				BkgColor (216,191,216) ;
			End

		Field (75,305,225,586) Alias 25  /* w_logo */ 
			Begin
				Borders (0,0,0,0) ;
				Bitmap
				Proportional BkgColor (255,228,225) ;
				Label "w_logo" 
			End

		Bitmap (83,808,232,1114) Proportional "Image.erp.company.images.LogoExample.jpg" 
			Begin
				Transparent
				Align 4 ;
				BkgColor (127,255,212) ;
			End

		Bitmap (148,9,223,294) Proportional "Image.framework.tbframeworkimages.images.20x20.ok.png" 
			Begin
				BkgColor (255,20,147) ;
			End

		Table (10,14) "ISO Country" Alias 7  /* ISO Country */ Origin (3,232) Heights (8,38,41,33) 
		HideTitle
		Title FontStyle "Text" ;
		Borders  RowSep Dynamic 
			Begin
				"Code" Alias 1  /* w_Isocountrycode */ Width 50 ;
				"Black List" Alias 16  /* BlackList */ Width 47 FormatStyle "Bool" Hidden Width 47 When 
				true  ;
				"Stato" Alias 13  /* w_Description */ Width 70 Break VMergeEqualCell ;
				"CountryCode" Alias 24  /* MA_ISOCountryCodes_CountryCode */ Width 0 Hidden Width 114 ;
				"Language" Alias 3  /* w_Language */ Width 61 Hidden Width 61 When ( Not IsActivated ( "ERP" , "Languages" ) )  ;
				"Description" Alias 12  /* w_LanguageDescription */ Width 100 Break Hidden Width 100 When ( Not IsActivated ( "ERP" , "Languages" ) )  ;
				"Currency" Alias 11  /* w_Currency */ Width 53 ;
				"Description" Alias 14  /* w_CurrDescription */ Width 70 Break Total ;
				"Fixing" Alias 20  /* MA_CurrenciesFixing_Fixing */ TextColor = 
				MA_CurrenciesFixing_Fixing < 10 ? rgb ( 255 , 0 , 0 ) : UseDefaultAttribute  BkgColor = 
				MA_CurrenciesFixing_Fixing > 100 ? rgb ( 0 , 255 , 255 ) : UseDefaultAttribute  Width 103 FormatStyle "Money" Total ;
				"Fixing Date" Alias 21  /* MA_CurrenciesFixing_FixingDate */ FontStyle = 
				MA_CurrenciesFixing_FixingDate != { d "" } ? "CellTextBig" : UseDefaultAttribute  Width 91 FormatStyle "Date" ;
				"Amount Rep." Alias 4  /* w_NumberFormat */ Width 0 FormatStyle "Enum" Hidden Width 100 ;
				"Date Rep." Alias 5  /* w_DateFormat */ Width 77 FormatStyle "Enum" ;
				"Time Rep." Alias 6  /* w_TimeFormat */ Width 71 FormatStyle "Enum" ;
				"EU State" Alias 15  /* w_EUCountry */ Width 55 FormatStyle "Bool" Hidden Width 55 When Not IsActivated ( "ERP" , "EuropeanUnion" )  ;
				Title
					Begin
						Column (0)  TextColor (254,0,254) Align 2133 ;
						Column (1)  Align 2133 ;
						Column (2,3)  FontStyle "ColumnTitleBig"  Align 2133 ;
						Column (4)  Align 2133 ;
						Column (5)  BkgColor (175,238,238) Align 2133 ;
						Column (6,13)  Align 2133 ;
					End
				ColTotal
					Begin
						Column (0,1)  Align 2149 ;
						Column (2)  Align 2148 ;
						Column (4)  Align 2149 ;
						Column (6)  BkgColor (152,251,152) Align 2149 ;
						Column (7)  TextColor (219,112,147) FontStyle "TotalNumber"  Align 2149 ;
						Column (8)  Align 2118 ;
						Column (13)  Align 2149 ;
					End

				Body
					Begin
						Rect (0,6,9,6) BkgColor (152,251,152) ;
						Rect (0,7,9,7) TextColor (100,149,237) ;
						Cell (0,0,9,0)  Align 2149 ;
						Cell (0,1,9,1)  Align 2149 ;
						Cell (0,4,9,4)  Align 2149 ;
						Cell (0,6,9,6)  Align 2149 ;
						Cell (0,7,9,7)  FontStyle "CellTextBig"  ;
						Cell (0,13,9,13)  Align 2149 ;
					End

			End


		Bitmap (239,809,333,1115) "Image.erp.company.images.LogoExample.jpg" 
			Begin
				Transparent
				Align 6 ;
				BkgColor (127,255,212) ;
			End

		Bitmap (338,970,546,1116) "Image.erp.company.images.LogoExample.jpg" 
			Begin
				Transparent
				Align 6 ;
				BkgColor (127,255,212) ;
			End

		Bitmap (552,811,701,1117) Proportional "Image.erp.company.images.LogoExample.jpg" 
			Begin
				Transparent
				Align 6 ;
				BkgColor (127,255,212) ;
			End

		Text (726,9,750,1066) "{Page} / {Page Number}" 
			Begin
				Style "PageNumber" 
				Special
			End

	End


Report 
	Begin NoName
		Tables
			Tabella_1 [10] Alias 7 ;
		End

		Variables
			String       w_Isocountrycode [2] Alias 1  Column ;
			String       w_Language [11] Alias 3  Column ;
			Enum[35]      /* Amount Rep. */ w_NumberFormat [10] Alias 4  Column ;
			Enum[36]      /* External Date Representation */ w_DateFormat [10] Alias 5  Column ;
			Enum[37]      /* External Time Representation */ w_TimeFormat [10] Alias 6  Column ;
			String       w_CompanyName [64] Alias 8 ;
			String       w_Currency [9] Alias 11  Column ;
			String       w_LanguageDescription [19,1] Alias 12  Column ;
			String       w_Description [22,1] Alias 13  Column ;
			String       w_CurrDescription [15,1] Alias 14  Column ;
			Bool         w_EUCountry [2] Alias 15  Column ;
			Bool         BlackList [3] Alias 16  Column ;
			Money        MA_CurrenciesFixing_Fixing [23] Alias 20  Column ;
			Date         MA_CurrenciesFixing_FixingDate [10] Alias 21  Column ;
			Money        TotMA_CurrenciesFixing_Fixing = Csum (MA_CurrenciesFixing_Fixing ) Alias 22  ColTotal ;
			String       Totw_CurrDescription = "Total"  Alias 23  ColTotal of w_CurrDescription ;
			String       MA_ISOCountryCodes_CountryCode [15] Alias 24  Column ;
			String       w_logo [15] Alias 25  Input Init = 
			"image.erp.company.LogoExample.jpg"  ;
		End

		Rules
			From MA_Company 
			Select  Not NULL 
				CompanyName          Into w_CompanyName ;

			From MA_ISOCountryCodes 
			Select  Not NULL 
				ISOCountryCode       Into w_Isocountrycode ,
				Language             Into w_Language ,
				NumberFormat         Into w_NumberFormat ,
				DateFormat           Into w_DateFormat ,
				TimeFormat           Into w_TimeFormat ,
				Currency             Into w_Currency ,
				Description          Into w_Description ,
				EUCountry            Into w_EUCountry ,
				BlackList            Into BlackList ,
				CountryCode          Into MA_ISOCountryCodes_CountryCode 
			Where MA_ISOCountryCodes.Disabled == FALSE  
			Order By  MA_ISOCountryCodes.ISOCountryCode ;

			From MA_Languages 
			Select 
				Description          Into w_LanguageDescription 
			Where MA_Languages.Language == w_Language  ;

			From MA_Currencies , MA_CurrenciesFixing 
			Select  Top 3
				MA_Currencies.Description Into w_CurrDescription ,
				MA_CurrenciesFixing.Fixing Into MA_CurrenciesFixing_Fixing ,
				MA_CurrenciesFixing.FixingDate Into MA_CurrenciesFixing_FixingDate 
			Where MA_Currencies.Currency == w_Currency 
				and MA_Currencies.Currency = MA_CurrenciesFixing.Currency 
				and MA_CurrenciesFixing.FixingDate != { d "" } 
				and MA_CurrenciesFixing.Fixing > 0.0123  ;
		End


		Events
			FormFeed : Do
				Before 
					Begin
						Display TotMA_CurrenciesFixing_Fixing ;
						Reset TotMA_CurrenciesFixing_Fixing ;
						Display Totw_CurrDescription ;
						Reset Totw_CurrDescription ;
					End
				After 
					Begin
					End

			Report : Do
				Always 
					Begin
						Eval TotMA_CurrenciesFixing_Fixing ;
						Eval Totw_CurrDescription ;
					End
				Before 
					Begin
					End
				After 
					Begin
						Display TotMA_CurrenciesFixing_Fixing ;
						Display Totw_CurrDescription ;
					End
				Finalize 
					Begin
					End
		End
End

