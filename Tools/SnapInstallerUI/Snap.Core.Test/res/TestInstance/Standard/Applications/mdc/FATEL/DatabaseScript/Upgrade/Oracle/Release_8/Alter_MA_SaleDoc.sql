
UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112640 WHERE MA_SALEDOC.FEPASTATUS = 30474240
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112840 WHERE MA_SALEDOC.FEPASTATUS = 30474241
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112841 WHERE MA_SALEDOC.FEPASTATUS = 30474242
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112842 WHERE MA_SALEDOC.FEPASTATUS = 30474243
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112843 WHERE MA_SALEDOC.FEPASTATUS = 30474244
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112844 WHERE MA_SALEDOC.FEPASTATUS = 30474245
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112845 WHERE MA_SALEDOC.FEPASTATUS = 30474246
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112846 WHERE MA_SALEDOC.FEPASTATUS = 30474247
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112847 WHERE MA_SALEDOC.FEPASTATUS = 30474248
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112848 WHERE MA_SALEDOC.FEPASTATUS = 30474249
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112849 WHERE MA_SALEDOC.FEPASTATUS = 30474250
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112850 WHERE MA_SALEDOC.FEPASTATUS = 30474251
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112851 WHERE MA_SALEDOC.FEPASTATUS = 30474252
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112852 WHERE MA_SALEDOC.FEPASTATUS = 30474253
GO

UPDATE MA_SALEDOC SET MA_SALEDOC.FEPASTATUS = 32112853 WHERE MA_SALEDOC.FEPASTATUS = 30474254
GO


UPDATE MA_FEPAPARAMETERS SET MA_FEPAPARAMETERS.DOCSTATUSCHECKERROR = 10682368 WHERE MA_FEPAPARAMETERS.DOCSTATUSCHECKERROR = 30801920 
GO

UPDATE MA_FEPAPARAMETERS SET MA_FEPAPARAMETERS.DOCSTATUSCHECKERROR = 10682369 WHERE MA_FEPAPARAMETERS.DOCSTATUSCHECKERROR = 30801921
GO

UPDATE MA_FEPAPARAMETERS SET MA_FEPAPARAMETERS.DOCSTATUSCHECKERROR = 10682370 WHERE MA_FEPAPARAMETERS.DOCSTATUSCHECKERROR = 30801922 
GO


BEGIN
	UPDATE MA_SALEDOC SET MA_SALEDOC.EISTATUS = MA_SALEDOC.FEPASTATUS WHERE MA_SALEDOC.SALEDOCID = MA_SALEDOC.SALEDOCID AND MA_SALEDOC.FEPASTATUS != 32112640;

	EXECUTE IMMEDIATE 'ALTER TABLE MA_SALEDOC DROP COLUMN FEPASTATUS';

	INSERT INTO MA_EI_ITDocAdditionalData ( DocID, DocSubID, Line, SubLine, FieldName, FieldValue) Select SaleDocId, 0, 0, 0, 'FatturaElettronica.FatturaElettronicaBody.DatiGenerali.DatiGeneraliDocumento.DatiRitenuta.CausalePagamento', 
	CASE WHEN FEPALetter770 = 'A'	THEN '32440320'
	     WHEN FEPALetter770 = 'B'	THEN '32440321'
		 WHEN FEPALetter770 = 'C'	THEN '32440322'
		 WHEN FEPALetter770 = 'D'	THEN '32440323'
		 WHEN FEPALetter770 = 'E'	THEN '32440324'
		 WHEN FEPALetter770 = 'G'	THEN '32440325'
		 WHEN FEPALetter770 = 'H'	THEN '32440326'
		 WHEN FEPALetter770 = 'I'	THEN '32440327'
		 WHEN FEPALetter770 = 'L'	THEN '32440328'
		 WHEN FEPALetter770 = 'M'	THEN '32440329'
		 WHEN FEPALetter770 = 'N'	THEN '32440330'
		 WHEN FEPALetter770 = 'O'	THEN '32440331'
		 WHEN FEPALetter770 = 'P'	THEN '32440332'
		 WHEN FEPALetter770 = 'Q'	THEN '32440333'
		 WHEN FEPALetter770 = 'R'	THEN '32440334'
		 WHEN FEPALetter770 = 'S'	THEN '32440335'
		 WHEN FEPALetter770 = 'T'	THEN '32440336'
		 WHEN FEPALetter770 = 'U'	THEN '32440337'
		 WHEN FEPALetter770 = 'V'	THEN '32440338'
		 WHEN FEPALetter770 = 'W'	THEN '32440339'
		 WHEN FEPALetter770 = 'X'	THEN '32440340'
		 WHEN FEPALetter770 = 'Y'	THEN '32440341'
		 WHEN FEPALetter770 = 'Z'	THEN '32440342'
		 WHEN FEPALetter770 = 'L1'	THEN '32440343'
		 WHEN FEPALetter770 = 'M1'	THEN '32440344'
		 WHEN FEPALetter770 = 'O1'	THEN '32440345'
		 WHEN FEPALetter770 = 'V1'	THEN '32440346'
		END AS FieldValue
	From MA_SaleDoc where FEPALetter770 = 'A' OR  FEPALetter770 = 'B' OR FEPALetter770 = 'C' OR FEPALetter770 = 'D' OR FEPALetter770 = 'E' 
		OR FEPALetter770 = 'G' OR  FEPALetter770 = 'H' OR FEPALetter770 = 'I' OR FEPALetter770 = 'L' OR FEPALetter770 = 'M'
		OR FEPALetter770 = 'N' OR  FEPALetter770 = 'O' OR FEPALetter770 = 'P' OR FEPALetter770 = 'Q' OR FEPALetter770 = 'R' 
		OR FEPALetter770 = 'S' OR  FEPALetter770 = 'T' OR FEPALetter770 = 'U' OR FEPALetter770 = 'V' OR FEPALetter770 = 'W' 
		OR FEPALetter770 = 'X' OR  FEPALetter770 = 'Y' OR FEPALetter770 = 'Z' OR FEPALetter770 = 'L1' OR FEPALetter770 = 'M1';

	EXECUTE IMMEDIATE 'ALTER TABLE MA_SALEDOC DROP COLUMN FEPALETTER770';
	
	EXCEPTION
	WHEN OTHERS THEN NULL;
END;
