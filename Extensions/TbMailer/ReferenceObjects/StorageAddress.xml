<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<HotKeyLink version="2" accessibility="Public" >

<Function namespace="Extensions.TbMailer.TbMailer.StorageAddress" localize="Storage's address" type="string">
  <Param name="localized_StartCode" type="string" localize="From Storage" value="From code" optional="true"/>
  <Param name="localized_EndCode" type="string" localize="To Storage" value="To code" optional="true"/>
</Function>

  <DbTable name="MA_Storages"  loadFullRecord="false" /> 
  <DbField name="MA_Storages.Description"/>
  <DbFieldDescription name="MA_Storages.Storage" />

  <Events>
   
    <Event name="OnAssignSelectedValue" type="bool">
      <Param name="p_CtrlValue" type="string" localize="Control value" mode="in out" />
      <Param name="p_HklValue" type="string" localize="Selected value" />
      <TbScript>
        <![CDATA[ 
        Begin
              if p_CtrlValue != ''
                then p_CtrlValue = p_CtrlValue + ';' + p_HklValue;
                else p_CtrlValue = p_HklValue;
        End
      ]]>
      </TbScript>
    </Event>
  </Events>

  <AskRules>
    <![CDATA[ 
    Variables 
      String ask_StartCode [15,1] Alias 1 Hidden Input Init = "" ; 
      String ask_EndCode [15,1] Alias 2 Hidden Input Init = "" ; 
    End
    Dialogs Begin 
      Dialog AskStorages "" 
      Begin 
         Controls Begin 
            Begin 
              ask_StartCode Prompt = (GetTitle("localized_StartCode")) LowerLimit HotLink ERP.MultiStorage.Dbl.Storages (2) ; 
              ask_EndCode Prompt = (GetTitle("localized_EndCode")) UpperLimit HotLink ERP.MultiStorage.Dbl.Storages (2) ; 
            End 
         End 
      End 
    End     
   ]]>
  </AskRules>
  
  <SelectionModes>
    <Mode name="Default" type="query">
  <![CDATA[  
SELECT 
     Storage              { COL MA_Storages.Storage }
     ,Description         { COL MA_Storages.Description }
     ,Fax                 { COL MA_Storages.Fax }
     ,Address             { COL MA_Storages.Address }
     ,City                { COL MA_Storages.City }
     ,ZIPCode             { COL MA_Storages.ZIPCode }
     ,County              { COL MA_Storages.County }
     ,Country             { COL MA_Storages.Country }
     ,Notes               { COL MA_Storages.Notes }
     ,Disabled            { COL MA_Storages.Disabled }          
     ,WMS                 { COL MA_Storages.WMS } 
 FROM MA_Storages
 WHERE 
    Storage BETWEEN { IN ask_StartCode } AND  { IN ask_EndCode }
 ORDER BY Description
 ]]>
  </Mode>

</SelectionModes>

</HotKeyLink>