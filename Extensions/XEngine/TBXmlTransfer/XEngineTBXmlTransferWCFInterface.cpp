//BEGIN_HEADING - file version: 1.0
//WARNING - automatically generated code - DO NOT EDIT THIS FILE!

#include "stdafx.h"

//BEGIN_SOURCE_INCLUDE
#include	"soapfunctions.h"
//END_SOURCE_INCLUDE

#include <atlsafe.h>
#include <TbGeneric\WebServiceStateObjects.h>
#include <TBNameSolver\Templates.h>
//END_HEADING


namespace XEngineTBXmlTransfer {

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) void __CloseLatestDocument(HWND _hwnd) throw(...)
	{

		AfxInvokeThreadGlobalProcedure(_hwnd, &CloseLatestDocument);


	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) BSTR __GetSiteCode(HWND _hwnd) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataStr>(_hwnd, &GetSiteCode);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) SAFEARRAY* __GetExportProfileList(HWND _hwnd, BSTR documentNamespace, int posType, BSTR userName) throw(...)
	{

		DataObjArray returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataStr userNameParam;
		userNameParam.SetSoapValue(userName);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataObjArray, DataStr, DataInt, DataStr>(_hwnd, &GetExportProfileList, documentNamespaceParam, posTypeParam, userNameParam);


		CComSafeArray<BSTR> sfarreturnValue;
		sfarreturnValue.Create(returnValueParam.GetSize());

		for (long i = 0; i < (long)sfarreturnValue.GetCount(); i++)
		{
			BSTR bstrreturnValue = ((DataStr*)returnValueParam.GetAt(i))->GetSoapValue();
			(sfarreturnValue)[i] = bstrreturnValue;
			::SysFreeString(bstrreturnValue);
		}


		return sfarreturnValue.Detach();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) BSTR __GetExportProfilesPath(HWND _hwnd, BSTR documentNamespace, int posType, BSTR userName) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataStr userNameParam;
		userNameParam.SetSoapValue(userName);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataStr, DataStr, DataInt, DataStr>(_hwnd, &GetExportProfilesPath, documentNamespaceParam, posTypeParam, userNameParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __OpenDocumentAndImport(HWND _hwnd, BSTR documentNamespace, BSTR envelopeFolder, BSTR* resultDescription) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr envelopeFolderParam;
		envelopeFolderParam.SetSoapValue(envelopeFolder);

		DataStr resultDescriptionParam;
		resultDescriptionParam.SetCollateCultureSensitive(TRUE);
		resultDescriptionParam.SetSoapValue(*resultDescription);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr, DataStr&>(_hwnd, &OpenDocumentAndImport, documentNamespaceParam, envelopeFolderParam, resultDescriptionParam);

		SysFreeString(*resultDescription);
		*resultDescription = resultDescriptionParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __Import(HWND _hwnd, long documentHandle, BSTR envelopeFolder, BSTR* resultDescription) throw(...)
	{

		DataBool returnValueParam;

		DataLng documentHandleParam;
		documentHandleParam.SetSoapValue(documentHandle);

		DataStr envelopeFolderParam;
		envelopeFolderParam.SetSoapValue(envelopeFolder);

		DataStr resultDescriptionParam;
		resultDescriptionParam.SetCollateCultureSensitive(TRUE);
		resultDescriptionParam.SetSoapValue(*resultDescription);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataLng, DataStr, DataStr&>(_hwnd, &Import, documentHandleParam, envelopeFolderParam, resultDescriptionParam);

		SysFreeString(*resultDescription);
		*resultDescription = resultDescriptionParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __GetXMLExportParameters(HWND _hwnd, BSTR documentNamespace, BSTR* xmlParams, SAFEARRAY** messages, BSTR code) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr xmlParamsParam;
		xmlParamsParam.SetCollateCultureSensitive(TRUE);
		xmlParamsParam.SetSoapValue(*xmlParams);

		DataObjArray messagesParam;

		CComSafeArray<BSTR> sfarmessages;
		if (*messages) {
			sfarmessages.Attach(*messages);
			for (long i = 0; i < (long)sfarmessages.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetCollateCultureSensitive(TRUE);
				pObj->SetSoapValue((sfarmessages)[i]);
				messagesParam.Add(pObj);
			}


		}
		DataStr codeParam;
		codeParam.SetCollateCultureSensitive(TRUE);
		codeParam.SetSoapValue(code);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr&, DataObjArray&, DataStr>(_hwnd, &GetXMLExportParameters, documentNamespaceParam, xmlParamsParam, messagesParam, codeParam);

		SysFreeString(*xmlParams);
		*xmlParams = xmlParamsParam.GetSoapValue();

		if (sfarmessages.m_psa)
			sfarmessages.Resize(messagesParam.GetSize());
		else
			sfarmessages.Create(messagesParam.GetSize());

		for (long i = 0; i < (long)sfarmessages.GetCount(); i++)
		{
			BSTR bstrmessages = ((DataStr*)messagesParam.GetAt(i))->GetSoapValue();
			(sfarmessages)[i] = bstrmessages;
			::SysFreeString(bstrmessages);
		}


		*messages = sfarmessages.Detach();
		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __GetXMLImportParameters(HWND _hwnd, BSTR documentNamespace, BSTR* xmlParams, SAFEARRAY** messages, BSTR code) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr xmlParamsParam;
		xmlParamsParam.SetCollateCultureSensitive(TRUE);
		xmlParamsParam.SetSoapValue(*xmlParams);

		DataObjArray messagesParam;

		CComSafeArray<BSTR> sfarmessages;
		if (*messages) {
			sfarmessages.Attach(*messages);
			for (long i = 0; i < (long)sfarmessages.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetCollateCultureSensitive(TRUE);
				pObj->SetSoapValue((sfarmessages)[i]);
				messagesParam.Add(pObj);
			}


		}
		DataStr codeParam;
		codeParam.SetCollateCultureSensitive(TRUE);
		codeParam.SetSoapValue(code);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr&, DataObjArray&, DataStr>(_hwnd, &GetXMLImportParameters, documentNamespaceParam, xmlParamsParam, messagesParam, codeParam);

		SysFreeString(*xmlParams);
		*xmlParams = xmlParamsParam.GetSoapValue();

		if (sfarmessages.m_psa)
			sfarmessages.Resize(messagesParam.GetSize());
		else
			sfarmessages.Create(messagesParam.GetSize());

		for (long i = 0; i < (long)sfarmessages.GetCount(); i++)
		{
			BSTR bstrmessages = ((DataStr*)messagesParam.GetAt(i))->GetSoapValue();
			(sfarmessages)[i] = bstrmessages;
			::SysFreeString(bstrmessages);
		}


		*messages = sfarmessages.Detach();
		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __RunXMLExportInUnattendedMode(HWND _hwnd, BSTR documentNamespace, BSTR xmlParams, long* documentHandle, SAFEARRAY** messages) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr xmlParamsParam;
		xmlParamsParam.SetCollateCultureSensitive(TRUE);
		xmlParamsParam.SetSoapValue(xmlParams);

		DataLng documentHandleParam;
		documentHandleParam.SetSoapValue(*documentHandle);

		DataObjArray messagesParam;

		CComSafeArray<BSTR> sfarmessages;
		if (*messages) {
			sfarmessages.Attach(*messages);
			for (long i = 0; i < (long)sfarmessages.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetCollateCultureSensitive(TRUE);
				pObj->SetSoapValue((sfarmessages)[i]);
				messagesParam.Add(pObj);
			}


		}
		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr, DataLng&, DataObjArray&>(_hwnd, &RunXMLExportInUnattendedMode, documentNamespaceParam, xmlParamsParam, documentHandleParam, messagesParam);

		*documentHandle = documentHandleParam.GetSoapValue();

		if (sfarmessages.m_psa)
			sfarmessages.Resize(messagesParam.GetSize());
		else
			sfarmessages.Create(messagesParam.GetSize());

		for (long i = 0; i < (long)sfarmessages.GetCount(); i++)
		{
			BSTR bstrmessages = ((DataStr*)messagesParam.GetAt(i))->GetSoapValue();
			(sfarmessages)[i] = bstrmessages;
			::SysFreeString(bstrmessages);
		}


		*messages = sfarmessages.Detach();
		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __RunXMLImportInUnattendedMode(HWND _hwnd, BSTR documentNamespace, bool downloadEnvelopes, bool validateData, BSTR xmlParams, long* documentHandle, SAFEARRAY** messages) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataBool downloadEnvelopesParam;
		downloadEnvelopesParam.SetSoapValue(downloadEnvelopes);

		DataBool validateDataParam;
		validateDataParam.SetSoapValue(validateData);

		DataStr xmlParamsParam;
		xmlParamsParam.SetCollateCultureSensitive(TRUE);
		xmlParamsParam.SetSoapValue(xmlParams);

		DataLng documentHandleParam;
		documentHandleParam.SetSoapValue(*documentHandle);

		DataObjArray messagesParam;

		CComSafeArray<BSTR> sfarmessages;
		if (*messages) {
			sfarmessages.Attach(*messages);
			for (long i = 0; i < (long)sfarmessages.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetCollateCultureSensitive(TRUE);
				pObj->SetSoapValue((sfarmessages)[i]);
				messagesParam.Add(pObj);
			}


		}
		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataBool, DataBool, DataStr, DataLng&, DataObjArray&>(_hwnd, &RunXMLImportInUnattendedMode, documentNamespaceParam, downloadEnvelopesParam, validateDataParam, xmlParamsParam, documentHandleParam, messagesParam);

		*documentHandle = documentHandleParam.GetSoapValue();

		if (sfarmessages.m_psa)
			sfarmessages.Resize(messagesParam.GetSize());
		else
			sfarmessages.Create(messagesParam.GetSize());

		for (long i = 0; i < (long)sfarmessages.GetCount(); i++)
		{
			BSTR bstrmessages = ((DataStr*)messagesParam.GetAt(i))->GetSoapValue();
			(sfarmessages)[i] = bstrmessages;
			::SysFreeString(bstrmessages);
		}


		*messages = sfarmessages.Detach();
		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __GetData(HWND _hwnd, BSTR param, bool useApproximation, BSTR loginName, SAFEARRAY** result) throw(...)
	{

		DataBool returnValueParam;

		DataStr paramParam;
		paramParam.SetSoapValue(param);

		DataBool useApproximationParam;
		useApproximationParam.SetSoapValue(useApproximation);

		DataStr loginNameParam;
		loginNameParam.SetSoapValue(loginName);

		DataArray resultParam;

		CComSafeArray<BSTR> sfarresult;
		if (*result) {
			sfarresult.Attach(*result);
			for (long i = 0; i < (long)sfarresult.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetCollateCultureSensitive(TRUE);
				pObj->SetSoapValue((sfarresult)[i]);
				resultParam.Add(pObj);
			}


		}
		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataBool, DataStr, DataArray&>(_hwnd, &GetData, paramParam, useApproximationParam, loginNameParam, resultParam);


		if (sfarresult.m_psa)
			sfarresult.Resize(resultParam.GetSize());
		else
			sfarresult.Create(resultParam.GetSize());

		for (long i = 0; i < (long)sfarresult.GetCount(); i++)
		{
			BSTR bstrresult = ((DataStr*)resultParam.GetAt(i))->GetSoapValue();
			(sfarresult)[i] = bstrresult;
			::SysFreeString(bstrresult);
		}


		*result = sfarresult.Detach();
		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __SetData(HWND _hwnd, BSTR data, int saveAction, BSTR loginName, BSTR* result) throw(...)
	{

		DataBool returnValueParam;

		DataStr dataParam;
		dataParam.SetSoapValue(data);

		DataInt saveActionParam;
		saveActionParam.SetSoapValue(saveAction);

		DataStr loginNameParam;
		loginNameParam.SetCollateCultureSensitive(TRUE);
		loginNameParam.SetSoapValue(loginName);

		DataStr resultParam;
		resultParam.SetCollateCultureSensitive(TRUE);
		resultParam.SetSoapValue(*result);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataInt, DataStr, DataStr&>(_hwnd, &SetData, dataParam, saveActionParam, loginNameParam, resultParam);

		SysFreeString(*result);
		*result = resultParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __GetXMLParameters(HWND _hwnd, BSTR param, bool useApproximation, BSTR loginName, BSTR* result) throw(...)
	{

		DataBool returnValueParam;

		DataStr paramParam;
		paramParam.SetSoapValue(param);

		DataBool useApproximationParam;
		useApproximationParam.SetSoapValue(useApproximation);

		DataStr loginNameParam;
		loginNameParam.SetSoapValue(loginName);

		DataStr resultParam;
		resultParam.SetCollateCultureSensitive(TRUE);
		resultParam.SetSoapValue(*result);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataBool, DataStr, DataStr&>(_hwnd, &GetXMLParameters, paramParam, useApproximationParam, loginNameParam, resultParam);

		SysFreeString(*result);
		*result = resultParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) BSTR __GetXMLHotLink(HWND _hwnd, BSTR documentNamespace, BSTR nsUri, BSTR fieldXPath, BSTR loginName) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr nsUriParam;
		nsUriParam.SetSoapValue(nsUri);

		DataStr fieldXPathParam;
		fieldXPathParam.SetSoapValue(fieldXPath);

		DataStr loginNameParam;
		loginNameParam.SetSoapValue(loginName);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataStr, DataStr, DataStr, DataStr, DataStr>(_hwnd, &GetXMLHotLink, documentNamespaceParam, nsUriParam, fieldXPathParam, loginNameParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __NewExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR newProfileName, int posType, BSTR userName, BSTR* profilePath) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr newProfileNameParam;
		newProfileNameParam.SetSoapValue(newProfileName);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataStr userNameParam;
		userNameParam.SetSoapValue(userName);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(*profilePath);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr, DataInt, DataStr, DataStr&>(_hwnd, &NewExportProfile, documentNamespaceParam, newProfileNameParam, posTypeParam, userNameParam, profilePathParam);

		SysFreeString(*profilePath);
		*profilePath = profilePathParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __CloneExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR* profilePath, int posType, BSTR userName) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(*profilePath);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataStr userNameParam;
		userNameParam.SetSoapValue(userName);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr&, DataInt, DataStr>(_hwnd, &CloneExportProfile, documentNamespaceParam, profilePathParam, posTypeParam, userNameParam);

		SysFreeString(*profilePath);
		*profilePath = profilePathParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __DeleteExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR profilePath) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(profilePath);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr>(_hwnd, &DeleteExportProfile, documentNamespaceParam, profilePathParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __RenameExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR* profilePath, BSTR newName) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(*profilePath);

		DataStr newNameParam;
		newNameParam.SetSoapValue(newName);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr&, DataStr>(_hwnd, &RenameExportProfile, documentNamespaceParam, profilePathParam, newNameParam);

		SysFreeString(*profilePath);
		*profilePath = profilePathParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __ModifyExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR* profilePath, int posType, BSTR userName) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(*profilePath);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataStr userNameParam;
		userNameParam.SetSoapValue(userName);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr&, DataInt, DataStr>(_hwnd, &ModifyExportProfile, documentNamespaceParam, profilePathParam, posTypeParam, userNameParam);

		SysFreeString(*profilePath);
		*profilePath = profilePathParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __ShowExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR profilePath) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(profilePath);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr>(_hwnd, &ShowExportProfile, documentNamespaceParam, profilePathParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __CopyExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR profilePath, int posType, SAFEARRAY* userArray) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(profilePath);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataObjArray userArrayParam;

		CComSafeArray<BSTR> sfaruserArray;
		if (userArray) {
			sfaruserArray.Attach(userArray);
			for (long i = 0; i < (long)sfaruserArray.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetSoapValue((sfaruserArray)[i]);
				userArrayParam.Add(pObj);
			}


			sfaruserArray.Detach();
		}
		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr, DataInt, DataObjArray>(_hwnd, &CopyExportProfile, documentNamespaceParam, profilePathParam, posTypeParam, userArrayParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __MoveExportProfile(HWND _hwnd, BSTR documentNamespace, BSTR profilePath, int posType, SAFEARRAY* userArray) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(profilePath);

		DataInt posTypeParam;
		posTypeParam.SetSoapValue(posType);

		DataObjArray userArrayParam;

		CComSafeArray<BSTR> sfaruserArray;
		if (userArray) {
			sfaruserArray.Attach(userArray);
			for (long i = 0; i < (long)sfaruserArray.GetCount(); i++) {
				DataStr *pObj = new DataStr();
				pObj->SetSoapValue((sfaruserArray)[i]);
				userArrayParam.Add(pObj);
			}


			sfaruserArray.Detach();
		}
		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr, DataInt, DataObjArray>(_hwnd, &MoveExportProfile, documentNamespaceParam, profilePathParam, posTypeParam, userArrayParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) bool __CreateSmartXSD(HWND _hwnd, BSTR documentNamespace, BSTR* profilePath) throw(...)
	{

		DataBool returnValueParam;

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profilePathParam;
		profilePathParam.SetSoapValue(*profilePath);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataBool, DataStr, DataStr&>(_hwnd, &CreateSmartXSD, documentNamespaceParam, profilePathParam);

		SysFreeString(*profilePath);
		*profilePath = profilePathParam.GetSoapValue();

		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) BSTR __GetDocumentSchema(HWND _hwnd, BSTR documentNamespace, BSTR profileName, BSTR forUser) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		DataStr documentNamespaceParam;
		documentNamespaceParam.SetSoapValue(documentNamespace);

		DataStr profileNameParam;
		profileNameParam.SetSoapValue(profileName);

		DataStr forUserParam;
		forUserParam.SetSoapValue(forUser);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataStr, DataStr, DataStr, DataStr>(_hwnd, &GetDocumentSchema, documentNamespaceParam, profileNameParam, forUserParam);


		return returnValueParam.GetSoapValue();
	}

	//File: XEngine\TBXmlTransfer\SoapFunctions.cpp.
	extern "C" __declspec(dllexport) BSTR __GetReportSchema(HWND _hwnd, BSTR reportNamespace, BSTR forUser) throw(...)
	{

		DataStr returnValueParam;
		returnValueParam.SetCollateCultureSensitive(TRUE);

		DataStr reportNamespaceParam;
		reportNamespaceParam.SetSoapValue(reportNamespace);

		DataStr forUserParam;
		forUserParam.SetSoapValue(forUser);

		returnValueParam = AfxInvokeThreadGlobalFunction<DataStr, DataStr, DataStr>(_hwnd, &GetReportSchema, reportNamespaceParam, forUserParam);


		return returnValueParam.GetSoapValue();
	}
}

TB_REGISTER_SOAP_SERVICE(XEngineTBXmlTransfer::CXEngineTBXmlTransfer)